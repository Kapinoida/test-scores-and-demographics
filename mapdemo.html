<!DOCTYPE html> 
<html> 
<head> 
<title>MAP and Student Demographics</title> 

	<style type="text/css" title="currentStyle">
		@import "/admin/sqlReports/DataTables/media/css/sqlReports.dataTables.css";
		@import "/admin/sqlReports/DataTables/extensions/Buttons/css/buttons.dataTables.css";
		@import "/admin/sqlReports/DataTables/extensions/FixedHeader/css/fixedHeader.dataTables.min.css";
		@import "/admin/sqlReports/DataTables/extensions/ColumnFiltering/css/ColumnFilterWidgets.css";
	</style>


	<script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/media/js/jquery.js"></script>
	<script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/media/js/jquery.dataTables10.min.js"></script>
    <script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/extensions/Select/js/dataTables.select.min.js"></script>
    <script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/extensions/Buttons/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/extensions/pdfmake/vfs_fonts.js"></script>
    <script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/extensions/Buttons/js/buttons.html5.min.js"></script>
    <script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/extensions/Buttons/js/buttons.colVis.min.js"></script>
    <script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/extensions/FixedHeader/js/dataTables.fixedHeader.min.js"></script>
    <script type="text/javascript" language="javascript" src="/admin/sqlReports/DataTables/extensions/ColReorder/js/dataTables.colReorder.min.js"></script>
    <script type="text/javascript" src="/admin/sqlReports/DataTables/extensions/ColumnFiltering/js/ColumnFilterWidgets.js"></script>
    <script lang="javascript" src="xlsx.js"></script>
	
<script type="text/javascript" charset="utf-8">
var $m = jQuery.noConflict();
$m(document).ready(function() {

if($m('table#dataresults tr th[class="DCID"]').index()>=0) {dcidcolvalue=$m('table#dataresults tr th[class="DCID"]').index()} else {dcidcolvalue=false};

if($m('table#dataresults tr th[class="DCID DISPLAY"]').index()>=0) {dciddisplaycolvalue=$m('table#dataresults tr th[class="DCID DISPLAY"]').index() + 1} else {dciddisplaycolvalue=1};

if($m('table#dataresults tr th[class="HIDE"]').index()>=0) {hidecolvalue=$j('table#dataresults tr th[class="HIDE"]').map(function() {return $m(this).index()}).get().join(',')} else {hidecolvalue='-1,'};

numofhides = $m('[class="HIDE"]').length;

if($m('table#dataresults tr th[class~="NOCF"]').index()>=0) {nocfcolvalue=$j('table#dataresults tr th[class~="NOCF"]').map(function() {return $m(this).index()}).get().join(',')} else {nocfcolvalue='-1'};

hideandnocf = hidecolvalue.concat(',',nocfcolvalue);

nofilter = hideandnocf.split(',');

nofilter.push(0,dcidcolvalue);

  var oTable  = $m('#dataresults').dataTable( {

<!-- Remove the W after the B to remove column filtering  --> 
    dom: 'BWlfrtip',

    select: {
            style: 'multi+shift'
        },

    "order": [],

        buttons: [

<!-- Begin Other Buttons  --> 
// 	{extend: 'csv', text: 'CSV', exportOptions: { columns: ':visible', modifier: { search: 'applied' }, format: {footer: function() {return ''}}}, header: true, footer: true},

<!-- End Other Buttons  --> 

        ],


        
<!-- Do not change the aoColumnDefs values  --> 
    "aoColumnDefs": [
            { "bSortable": false, "aTargets": [ 0 ] }
        ],	

    "aoColumnDefs": [
            { "bVisible": false, "aTargets": [ dcidcolvalue, "HIDE"  ] },
            { "bSearchable": false, "aTargets": [ dcidcolvalue, "HIDE"  ] }
        ],

    "paging":   false,
	"lengthChange": false,
	"ordering": true,
	"autoWidth": false,
    "searching": true,
    "info": true,
    fixedHeader: true,
	"oColumnFilterWidgets": {"aiExclude": nofilter},
    } );
} );

</script>



<!-- Required style sheets: screen.css, and print.css --> 
	<link href="/images/css/screen.css" rel="stylesheet" media="screen"> 
	<link href="/images/css/print.css" rel="stylesheet" media="print"> 
	
<!-- Commonscripts wildcard needs to load last --> 
	~[wc:commonscripts] 
</head>

<body>

~[wc:admin_header_css]<!-- breadcrumb start --><a href="/admin/home.html" target="_top">~[text:psx.html.admin_district.home.start_page]</a> &gt; MAP and Student Demographics<!-- breadcrumb end -->~[wc:admin_navigation_css]

<div class="box-round"> 

<h1>MAP and Student Demographics</h1>

<button id="xlsx" onclick="exportXLSX()">Excel</button>


<!-- Do not change the table id or class  -->
<table id="dataresults" class="display grid">
 	 
<thead>
<tr bgcolor="#f6f6f6">
    <th class="NOCF">Student #</th>
    <th class="NOCF">Last Name</th>
	<th class="NOCF">First Name</th>
	<th align="center">Gender</th>
	<th align="left">Grade Level</th>
	<th align="left">Home Room</th>
	<th class="team" align="left">Team</th>
	<th class="adv" align="CENTER">Adv ELA</th>
	<th class="adv" align="CENTER">Adv Math</th>
	<th class="li" align="CENTER">Low Income?</th>
	<th class="fof" align="CENTER">Has 504?</th>
	<th class="iep" align="CENTER">Has IEP?</th>
	<th class="lep" align="CENTER">Is LEP?</th>
	<th class="eth" align="CENTER">Ethnicity</th>
	<th class='NOCF cur spring' align="CENTER"> Spring ELA</th>
	<th class='NOCF cur spring' align="CENTER"> Spring Reading</th>
	<th class='NOCF cur spring' align="CENTER"> Spring Math</th>
	<th class='NOCF cur spring' align="CENTER"> Spring Science</th>
	<th class='NOCF cur winter' align="CENTER"> Winter ELA</th>
	<th class='NOCF cur winter' align="CENTER"> Winter Reading</th>
	<th class='NOCF cur winter' align="CENTER"> Winter Math</th>
	<th class='NOCF cur winter' align="CENTER"> Winter Science</th>
	<th class='NOCF cur' align="CENTER"> Fall ELA</th>
	<th class='NOCF cur' align="CENTER"> Fall Reading</th>
	<th class='NOCF cur' align="CENTER"> Fall Math</th>
	<th class='NOCF cur' align="CENTER"> Fall Science</th>
	
	<th class='NOCF prev' align="CENTER"> Spring ELA</th>
	<th class='NOCF prev' align="CENTER"> Spring Reading</th>
	<th class='NOCF prev' align="CENTER"> Spring Math</th>
	<th class='NOCF prev' align="CENTER"> Spring Science</th>
	<th class='NOCF prev' align="CENTER"> Winter ELA</th>
	<th class='NOCF prev' align="CENTER"> Winter Reading</th>
	<th class='NOCF prev' align="CENTER"> Winter Math</th>
	<th class='NOCF prev' align="CENTER"> Winter Science</th>
	<th class='NOCF prev' align="CENTER"> Fall ELA</th>
	<th class='NOCF prev' align="CENTER"> Fall Reading</th>
	<th class='NOCF prev' align="CENTER"> Fall Math</th>
	<th class='NOCF prev' align="CENTER"> Fall Science</th>
	
	<th class='NOCF prev2' align="CENTER"> Spring ELA</th>
	<th class='NOCF prev2' align="CENTER"> Spring Reading</th>
	<th class='NOCF prev2' align="CENTER"> Spring Math</th>
	<th class='NOCF prev2' align="CENTER"> Spring Science</th>
	<th class='NOCF prev2' align="CENTER"> Winter ELA</th>
	<th class='NOCF prev2' align="CENTER"> Winter Reading</th>
	<th class='NOCF prev2' align="CENTER"> Winter Math</th>
	<th class='NOCF prev2' align="CENTER"> Winter Science</th>
	<th class='NOCF prev2' align="CENTER"> Fall ELA</th>
	<th class='NOCF prev2' align="CENTER"> Fall Reading</th>
	<th class='NOCF prev2' align="CENTER"> Fall Math</th>
	<th class='NOCF prev2' align="CENTER"> Fall Science</th>
	
</tr>
</thead>
<tbody>

~[tlist_sql;

WITH TESTSCORES AS (
	SELECT
		students.id,
		studenttestscore.percentscore,
		studenttestscore.alphascore,
		studenttestscore.numscore,
		studenttest.test_date,
		test.name || ' ' || testscore.name concat,
		test.name,
		testscore.name testscorename
	FROM
		students
		INNER JOIN studenttest ON studenttest.studentid = students.ID
		INNER JOIN test ON test.ID = studenttest.testid
		INNER JOIN studenttestscore ON studenttestscore.studenttestid = studenttest.id
		INNER JOIN testscore ON testscore.id = studenttestscore.testscoreid
	WHERE
		students.enroll_status = 0
		AND studenttestscore.numscore <> 0
		-- This part weeds out the full test that have something in the alphascore field (like Spanish tests).
		-- It eliminates multiple rows for kids that have two testing results for the same period of time.
		AND NOT EXISTS (
			SELECT 
				1
			FROM 
				studenttestscore
			WHERE 
				studenttest.id = studenttestscore.studenttestid 
				AND studenttestscore.alphascore IS NOT NULL
		)
)

SELECT
	students.student_number,
	students.last_name,
	students.first_name,
	students.gender,
	students.grade_level,
	students.home_room,
	students.team,
	
	CASE WHEN u_custom_demographic.adv_ela = 'N' THEN 'No'
	WHEN u_custom_demographic.adv_ela = 'Y' THEN 'Yes'
	ELSE u_custom_demographic.adv_ela END as advELA,
	
	CASE WHEN u_custom_demographic.adv_ma = 'N' THEN 'No'
	WHEN u_custom_demographic.adv_ma = 'Y' THEN 'Yes'
	ELSE u_custom_demographic.adv_ma END advMA,
	
	CASE WHEN to_char(s_il_stu_x.lii) = '0' THEN 'No'
	WHEN to_char(s_il_stu_x.lii) = '1' THEN 'Yes'
	WHEN to_char(s_il_stu_x.lii) IS NULL THEN 'No'
	ELSE to_char(s_il_stu_x.lii) END lowIncome,
	
	CASE WHEN to_char(s_il_stu_plan504_x.participant) = '0' THEN 'No'
	WHEN to_char(s_il_stu_plan504_x.participant) = '1' THEN 'Yes'
	WHEN to_char(s_il_stu_plan504_x.participant) IS NULL THEN 'No'
	ELSE to_char(s_il_stu_plan504_x.participant) END has504,
	
	CASE WHEN to_char(u_custom_demographic.has_iep) = 'N' THEN 'No'
	WHEN to_char(u_custom_demographic.has_iep) = 'Y' THEN 'Yes'
	WHEN to_char(u_custom_demographic.has_iep) IS NULL THEN 'No'
	ELSE to_char(u_custom_demographic.has_iep) END hasIEP,
	
	CASE WHEN to_char(S_IL_STU_X.LEP) = '0' THEN 'No'
	WHEN to_char(S_IL_STU_X.LEP) = '1' THEN 'Yes'
	WHEN to_char(S_IL_STU_X.LEP) IS NULL THEN 'No'
	ELSE to_char(S_IL_STU_X.LEP) END isLEP,
	
	(
		SELECT
			gen.name
		FROM
			gen
		WHERE
			gen.cat = 'ethnicity'
			AND gen.value = students.ethnicity
	) ethnicity,
	
	curspringela.percentscore "curspringela",
	curspringreading.percentscore "curspringreading",
	curspringmath.percentscore "curspringmath",
	curspringscience.percentscore "curspringscience",

	curwinterela.percentscore "curwinterela",
	curwinterreading.percentscore "curwinterreading",
	curwintermath.percentscore "curwintermath",
	curwinterscience.percentscore "curwinterscience",
	
	curfallela.percentscore "curfallela",
	curfallreading.percentscore "curfallreading",
	curfallmath.percentscore "curfallmath",
	curfallscience.percentscore "curfallscience",
	
	prevspringela.percentscore "prevspringela",
	prevspringreading.percentscore "prevspringreading",
	prevspringmath.percentscore "prevspringmath",
	prevspringscience.percentscore "prevspringscience",
	
	prevwinterela.percentscore "prevwinterela",
	prevwinterreading.percentscore "prevwinterreading",
	prevwintermath.percentscore "prevwintermath",
	prevwinterscience.percentscore "prevwinterscience",
	
	prevfallela.percentscore "prevfallela",
	prevfallreading.percentscore "prevfallreading",
	prevfallmath.percentscore "prevfallmath",
	prevfallscience.percentscore "prevfallscience",
	
	prev2springela.percentscore "prev2springela",
	prev2springreading.percentscore "prev2springreading",
	prev2springmath.percentscore "prev2springmath",
	prev2springscience.percentscore "prev2springscience",

	prev2winterela.percentscore "prev2winterela",
	prev2winterreading.percentscore "prev2winterreading",
	prev2wintermath.percentscore "prev2wintermath",
	prev2winterscience.percentscore "prev2winterscience",
	
	prev2fallela.percentscore "prev2fallela",
	prev2fallreading.percentscore "prev2fallreading",
	prev2fallmath.percentscore "prev2fallmath",
	prev2fallscience.percentscore "prev2fallscience"
	
FROM
	Students
	JOIN u_custom_demographic ON u_custom_demographic.studentsdcid = students.dcid
	JOIN s_il_stu_x ON s_il_stu_x.studentsdcid = students.dcid
	LEFT JOIN s_il_stu_plan504_x ON s_il_stu_plan504_x.studentsdcid = students.dcid
	-- ELA
	LEFT JOIN TESTSCORES curspringela ON 
		students.id = curspringela.id 
		AND curspringela.name LIKE '%Spring'
		AND curspringela.testscorename = 'Language Arts'
		AND curspringela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curspringela.alphascore IS NULL
		AND curspringela.numscore <> 0
	LEFT JOIN TESTSCORES curwinterela ON 
		students.id = curwinterela.id 
		AND curwinterela.name LIKE '%Winter'
		AND curwinterela.testscorename = 'Language Arts'
		AND curwinterela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curwinterela.alphascore IS NULL
		AND curwinterela.numscore <> 0
	LEFT JOIN TESTSCORES curfallela ON 
		students.id = curfallela.id 
		AND curfallela.name LIKE '%Fall'
		AND curfallela.testscorename = 'Language Arts'
		AND curfallela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curfallela.alphascore IS NULL
		AND curfallela.numscore <> 0
	LEFT JOIN TESTSCORES prevspringela ON 
		students.id = prevspringela.id 
		AND prevspringela.name LIKE '%Spring'
		AND prevspringela.testscorename = 'Language Arts'
		AND prevspringela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevspringela.alphascore IS NULL
		AND prevspringela.numscore <> 0
	LEFT JOIN TESTSCORES prevwinterela ON 
		students.id = prevwinterela.id 
		AND prevwinterela.name LIKE '%Winter'
		AND prevwinterela.testscorename = 'Language Arts'
		AND prevwinterela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevwinterela.alphascore IS NULL
		AND prevwinterela.numscore <> 0
	LEFT JOIN TESTSCORES prevfallela ON 
		students.id = prevfallela.id 
		AND prevfallela.name LIKE '%Fall'
		AND prevfallela.testscorename = 'Language Arts'
		AND prevfallela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevfallela.alphascore IS NULL
		AND prevfallela.numscore <> 0
	LEFT JOIN TESTSCORES prev2springela ON 
		students.id = prev2springela.id 
		AND prev2springela.name LIKE '%Spring'
		AND prev2springela.testscorename = 'Language Arts'
		AND prev2springela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2springela.alphascore IS NULL
		AND prev2springela.numscore <> 0
	LEFT JOIN TESTSCORES prev2winterela ON 
		students.id = prev2winterela.id 
		AND prev2winterela.name LIKE '%Winter'
		AND prev2winterela.testscorename = 'Language Arts'
		AND prev2winterela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2winterela.alphascore IS NULL
		AND prev2winterela.numscore <> 0
	LEFT JOIN TESTSCORES prev2fallela ON 
		students.id = prev2fallela.id 
		AND prev2fallela.name LIKE '%Fall'
		AND prev2fallela.testscorename = 'Language Arts'
		AND prev2fallela.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2fallela.alphascore IS NULL
		AND prev2fallela.numscore <> 0
	-- Reading
	LEFT JOIN TESTSCORES curspringreading ON 
		students.id = curspringreading.id 
		AND curspringreading.name LIKE '%Spring'
		AND curspringreading.testscorename = 'Reading'
		AND curspringreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curspringreading.alphascore IS NULL
		AND curspringreading.numscore <> 0
	LEFT JOIN TESTSCORES curwinterreading ON 
		students.id = curwinterreading.id 
		AND curwinterreading.name LIKE '%Winter'
		AND curwinterreading.testscorename = 'Reading'
		AND curwinterreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curwinterreading.alphascore IS NULL
		AND curwinterreading.numscore <> 0
	LEFT JOIN TESTSCORES curfallreading ON 
		students.id = curfallreading.id 
		AND curfallreading.name LIKE '%Fall'
		AND curfallreading.testscorename = 'Reading'
		AND curfallreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curfallreading.alphascore IS NULL
		AND curfallreading.numscore <> 0
	LEFT JOIN TESTSCORES prevspringreading ON 
		students.id = prevspringreading.id 
		AND prevspringreading.name LIKE '%Spring'
		AND prevspringreading.testscorename = 'Reading'
		AND prevspringreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevspringreading.alphascore IS NULL
		AND prevspringreading.numscore <> 0
	LEFT JOIN TESTSCORES prevwinterreading ON 
		students.id = prevwinterreading.id 
		AND prevwinterreading.name LIKE '%Winter'
		AND prevwinterreading.testscorename = 'Reading'
		AND prevwinterreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevwinterreading.alphascore IS NULL
		AND prevwinterreading.numscore <> 0
	LEFT JOIN TESTSCORES prevfallreading ON 
		students.id = prevfallreading.id 
		AND prevfallreading.name LIKE '%Fall'
		AND prevfallreading.testscorename = 'Reading'
		AND prevfallreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevfallreading.alphascore IS NULL
		AND prevfallreading.numscore <> 0
	LEFT JOIN TESTSCORES prev2springreading ON 
		students.id = prev2springreading.id 
		AND prev2springreading.name LIKE '%Spring'
		AND prev2springreading.testscorename = 'Reading'
		AND prev2springreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2springreading.alphascore IS NULL
		AND prev2springreading.numscore <> 0
	LEFT JOIN TESTSCORES prev2winterreading ON 
		students.id = prev2winterreading.id 
		AND prev2winterreading.name LIKE '%Winter'
		AND prev2winterreading.testscorename = 'Reading'
		AND prev2winterreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2winterreading.alphascore IS NULL
		AND prev2winterreading.numscore <> 0
	LEFT JOIN TESTSCORES prev2fallreading ON 
		students.id = prev2fallreading.id 
		AND prev2fallreading.name LIKE '%Fall'
		AND prev2fallreading.testscorename = 'Reading'
		AND prev2fallreading.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2fallreading.alphascore IS NULL
		AND prev2fallreading.numscore <> 0
	-- Math
	LEFT JOIN TESTSCORES curspringmath ON 
		students.id = curspringmath.id 
		AND curspringmath.name LIKE '%Spring'
		AND curspringmath.testscorename = 'Math'
		AND curspringmath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curspringmath.alphascore IS NULL
		AND curspringmath.numscore <> 0
	LEFT JOIN TESTSCORES curwintermath ON 
		students.id = curwintermath.id 
		AND curwintermath.name LIKE '%Winter'
		AND curwintermath.testscorename = 'Math'
		AND curwintermath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curwintermath.alphascore IS NULL
		AND curwintermath.numscore <> 0
	LEFT JOIN TESTSCORES curfallmath ON 
		students.id = curfallmath.id 
		AND curfallmath.name LIKE '%Fall'
		AND curfallmath.testscorename = 'Math'
		AND curfallmath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curfallmath.alphascore IS NULL
		AND curfallmath.numscore <> 0
	LEFT JOIN TESTSCORES prevspringmath ON 
		students.id = prevspringmath.id 
		AND prevspringmath.name LIKE '%Spring'
		AND prevspringmath.testscorename = 'Math'
		AND prevspringmath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevspringmath.alphascore IS NULL
		AND prevspringmath.numscore <> 0
	LEFT JOIN TESTSCORES prevwintermath ON 
		students.id = prevwintermath.id 
		AND prevwintermath.name LIKE '%Winter'
		AND prevwintermath.testscorename = 'Math'
		AND prevwintermath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevwintermath.alphascore IS NULL
		AND prevwintermath.numscore <> 0
	LEFT JOIN TESTSCORES prevfallmath ON 
		students.id = prevfallmath.id 
		AND prevfallmath.name LIKE '%Fall'
		AND prevfallmath.testscorename = 'Math'
		AND prevfallmath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevfallmath.alphascore IS NULL
		AND prevfallmath.numscore <> 0
	LEFT JOIN TESTSCORES prev2springmath ON 
		students.id = prev2springmath.id 
		AND prev2springmath.name LIKE '%Spring'
		AND prev2springmath.testscorename = 'Math'
		AND prev2springmath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2springmath.alphascore IS NULL
		AND prev2springmath.numscore <> 0
	LEFT JOIN TESTSCORES prev2wintermath ON 
		students.id = prev2wintermath.id 
		AND prev2wintermath.name LIKE '%Winter'
		AND prev2wintermath.testscorename = 'Math'
		AND prev2wintermath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2wintermath.alphascore IS NULL
		AND prev2wintermath.numscore <> 0
	LEFT JOIN TESTSCORES prev2fallmath ON 
		students.id = prev2fallmath.id 
		AND prev2fallmath.name LIKE '%Fall'
		AND prev2fallmath.testscorename = 'Math'
		AND prev2fallmath.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2fallmath.alphascore IS NULL
		AND prev2fallmath.numscore <> 0
	-- Science
	LEFT JOIN TESTSCORES curspringscience ON 
		students.id = curspringscience.id 
		AND curspringscience.name LIKE '%Spring'
		AND curspringscience.testscorename = 'Science'
		AND curspringscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curspringscience.alphascore IS NULL
		AND curspringscience.numscore <> 0
	LEFT JOIN TESTSCORES curwinterscience ON 
		students.id = curwinterscience.id 
		AND curwinterscience.name LIKE '%Winter'
		AND curwinterscience.testscorename = 'Science'
		AND curwinterscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curwinterscience.alphascore IS NULL
		AND curwinterscience.numscore <> 0
	LEFT JOIN TESTSCORES curfallscience ON 
		students.id = curfallscience.id 
		AND curfallscience.name LIKE '%Fall'
		AND curfallscience.testscorename = 'Science'
		AND curfallscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1991)), 'MM/DD/YYYY')
		AND curfallscience.alphascore IS NULL
		AND curfallscience.numscore <> 0
	LEFT JOIN TESTSCORES prevspringscience ON 
		students.id = prevspringscience.id 
		AND prevspringscience.name LIKE '%Spring'
		AND prevspringscience.testscorename = 'Science'
		AND prevspringscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevspringscience.alphascore IS NULL
		AND prevspringscience.numscore <> 0
	LEFT JOIN TESTSCORES prevwinterscience ON 
		students.id = prevwinterscience.id 
		AND prevwinterscience.name LIKE '%Winter'
		AND prevwinterscience.testscorename = 'Science'
		AND prevwinterscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevwinterscience.alphascore IS NULL
		AND prevwinterscience.numscore <> 0
	LEFT JOIN TESTSCORES prevfallscience ON 
		students.id = prevfallscience.id 
		AND prevfallscience.name LIKE '%Fall'
		AND prevfallscience.testscorename = 'Science'
		AND prevfallscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1990)), 'MM/DD/YYYY')
		AND prevfallscience.alphascore IS NULL
		AND prevfallscience.numscore <> 0
	LEFT JOIN TESTSCORES prev2springscience ON 
		students.id = prev2springscience.id 
		AND prev2springscience.name LIKE '%Spring'
		AND prev2springscience.testscorename = 'Science'
		AND prev2springscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2springscience.alphascore IS NULL
		AND prev2springscience.numscore <> 0
	LEFT JOIN TESTSCORES prev2winterscience ON 
		students.id = prev2winterscience.id 
		AND prev2winterscience.name LIKE '%Winter'
		AND prev2winterscience.testscorename = 'Science'
		AND prev2winterscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2winterscience.alphascore IS NULL
		AND prev2winterscience.numscore <> 0
	LEFT JOIN TESTSCORES prev2fallscience ON 
		students.id = prev2fallscience.id 
		AND prev2fallscience.name LIKE '%Fall'
		AND prev2fallscience.testscorename = 'Science'
		AND prev2fallscience.test_date BETWEEN TO_DATE(CONCAT('08/01/', to_char(~(curyearid) + 1988)), 'MM/DD/YYYY') AND TO_DATE(CONCAT('05/31/', to_char(~(curyearid) + 1989)), 'MM/DD/YYYY')
		AND prev2fallscience.alphascore IS NULL
		AND prev2fallscience.numscore <> 0
	
WHERE
	~(curschoolid) in (0, students.schoolid)
    AND students.schoolid <> 31948
	AND students.enroll_status = 0
	AND S_IL_STU_X.RCDTS_SERVING_SCHOOL IS NULL

ORDER BY
	students.last_name

]
<tr>
    <td align="left">~(students.student_number)</td>
    <td align="left">~(students.last_name)</td>
	<td align="left">~(students.first_name)</td>
	<td align="center">~(students.gender)</td>
	<td align="center">~(students.grade_level)</td>
	<td align="center">~(students.home_room)</td>
	<td class="team" align="LEFT">~(students.team)</td>
	<td class="adv" align="CENTER">~(advELA;f)</td>
	<td class="adv" align="CENTER">~(advMA;f)</td>
	<td class="li" align="CENTER">~(lowIncome;f)</td>
	<td class="fof" align="CENTER">~(has504;f)</td>
	<td class="iep" align="CENTER">~(hasIEP;f)</td>
	<td class="lep" align="CENTER">~(isLEP;f)</td>
	<td class="eth" align="LEFT">~(ethnicity;f)</td>
	<td class='score spring' align="CENTER">~(curspringela;f)</td>
	<td class='score spring' align="CENTER">~(curspringrd;f)</td>
	<td class='score spring' align="CENTER">~(curspringma;f)</td>
	<td class='score spring' align="CENTER">~(curspringsci;f)</td>
	<td class='score winter' align="CENTER">~(curwinterela;f)</td>
	<td class='score winter' align="CENTER">~(curwinterrd;f)</td>
	<td class='score winter' align="CENTER">~(curwinterma;f)</td>
	<td class='score winter' align="CENTER">~(curwintersci;f)</td>
	<td class='score' align="CENTER">~(curfallela;f)</td>
	<td class='score' align="CENTER">~(curfallrd;f)</td>
	<td class='score' align="CENTER">~(curfallma;f)</td>
	<td class='score' align="CENTER">~(curfallsci;f)</td>
	<td class='score' align="CENTER">~(prevspringela;f)</td>
	<td class='score' align="CENTER">~(prevspringrd;f)</td>
	<td class='score' align="CENTER">~(prevspringma;f)</td>
	<td class='score' align="CENTER">~(prevspringsci;f)</td>
	<td class='score' align="CENTER">~(prevwinterela;f)</td>
	<td class='score' align="CENTER">~(prevwinterrd;f)</td>
	<td class='score' align="CENTER">~(prevwinterma;f)</td>
	<td class='score' align="CENTER">~(prevwintersci;f)</td>
	<td class='score' align="CENTER">~(prevfallela;f)</td>
	<td class='score' align="CENTER">~(prevfallrd;f)</td>
	<td class='score' align="CENTER">~(prevfallma;f)</td>
	<td class='score' align="CENTER">~(prevfallsci;f)</td>
	<td class='score' align="CENTER">~(prev2springela;f)</td>
	<td class='score' align="CENTER">~(prev2springrd;f)</td>
	<td class='score' align="CENTER">~(prev2springma;f)</td>
	<td class='score' align="CENTER">~(prev2springsci;f)</td>
	<td class='score' align="CENTER">~(prev2winterela;f)</td>
	<td class='score' align="CENTER">~(prev2winterrd;f)</td>
	<td class='score' align="CENTER">~(prev2winterma;f)</td>
	<td class='score' align="CENTER">~(prev2wintersci;f)</td>
	<td class='score' align="CENTER">~(prev2fallela;f)</td>
	<td class='score' align="CENTER">~(prev2fallrd;f)</td>
	<td class='score' align="CENTER">~(prev2fallma;f)</td>
	<td class='score' align="CENTER">~(prev2fallsci;f)</td>

</tr>
[/tlist_sql]
</tbody>

</table>

<!-- End of content table -->

</div> 

~[wc:admin_footer_css] 

<script>

    var currentYear = ~(curyearid) + 1990;
    var currentSchYear = String(currentYear).slice(-2) + '/' + String(currentYear + 1).slice(-2)
    var prevSchYear = String(currentYear - 1).slice(-2) + '/' + String(currentYear).slice(-2)
    var prev2SchYear = String(currentYear - 2).slice(-2) + '/' + String(currentYear - 1).slice(-2)
    
    var current = document.getElementsByClassName('cur')
    for (var i = 0; i < current.length; i++) {
        text = current[i].innerHTML
        current[i].innerHTML = currentSchYear + text
    }
    
    var previous = document.getElementsByClassName('prev')
    for (var i = 0; i < previous.length; i++) {
        text = previous[i].innerHTML
        previous[i].innerHTML = prevSchYear + text
    }
    
    var previous2 = document.getElementsByClassName('prev2')
    for (var i = 0; i < previous2.length; i++) {
        text = previous2[i].innerHTML
        previous2[i].innerHTML = prev2SchYear + text
    }
    
    const d = new Date();
    const month = d.getMonth();
    const year = d.getFullYear();
    
    var spring = document.getElementsByClassName('spring')
    var winter = document.getElementsByClassName('winter')
    
    if (((month == 11) && (year == currentYear)) || (((month >= 0) && (month < 3) && (year == (currentYear + 1))))) {
        for (var i = 0; i < spring.length; i++) {
            spring[i].style.display = 'none';
        }
    } else if (((month >= 8) && (month < 11)) && (year == currentYear)) {
        for (var i = 0; i < spring.length; i++) {
            spring[i].style.display = 'none';
        }
        for (var i = 0; i < winter.length; i++) {
            winter[i].style.display = 'none';
        }
    }
    
    const s = ~(curschoolid)
    
    var adv = document.getElementsByClassName('adv')
    var team = document.getElementsByClassName('team')
    
    if ((s != '5177') && (s != '0')) {
        for (var i = 0; i < team.length; i++) {
            team[i].style.display = 'none';
        }
        
        if ((s != '5197')) {
            for (var i = 0; i < adv.length; i++) {
                adv[i].style.display = 'none';
            }
        } 
    } 
    
    for (var i = 0; i < team.length; i++) {
        if (team[i].innerHTML.endsWith("Blue")) {
            team[i].style.backgroundColor = '#86e1e0';
        } else if (team[i].innerHTML.endsWith("Green")) {
            team[i].style.backgroundColor = '#a4fbaa';
        } else if (team[i].innerHTML.endsWith("Orange")) {
            team[i].style.backgroundColor = '#fbd3b2';
        } else if (team[i].innerHTML.endsWith("Purple")) {
            team[i].style.backgroundColor = '#b494c5';
        } else if (team[i].innerHTML.endsWith("Red")) {
            team[i].style.backgroundColor = '#FF8080';
        }
    }
    
    for (var i = 0; i < adv.length; i++) {
        if (adv[i].innerHTML == "Yes") {
            adv[i].style.backgroundColor = '#CDFAD5';
        } else if (adv[i].innerHTML == "No") {
            adv[i].style.backgroundColor = '#f9b9b9';
        }
    }
    
    
    var li = document.getElementsByClassName('li')
    var fof = document.getElementsByClassName('fof')
    var iep = document.getElementsByClassName('iep')
    var lep = document.getElementsByClassName('lep')
    
    for (var i = 0; i < li.length; i++) {
        if (li[i].innerHTML == "Yes") {
            li[i].style.backgroundColor = '#CDFAD5';
        } else if (li[i].innerHTML == "No") {
            li[i].style.backgroundColor = '#f9b9b9';
        }
    }
    
    for (var i = 0; i < fof.length; i++) {
        if (fof[i].innerHTML == "Yes") {
            fof[i].style.backgroundColor = '#CDFAD5';
        } else if (fof[i].innerHTML == "No") {
            fof[i].style.backgroundColor = '#f9b9b9';
        }
    }
    
    for (var i = 0; i < iep.length; i++) {
        if (iep[i].innerHTML == "Yes") {
            iep[i].style.backgroundColor = '#CDFAD5';
        } else if (iep[i].innerHTML == "No") {
            iep[i].style.backgroundColor = '#f9b9b9';
        }
    }
    
    for (var i = 0; i < lep.length; i++) {
        if (lep[i].innerHTML == "Yes") {
            lep[i].style.backgroundColor = '#CDFAD5';
        } else if (lep[i].innerHTML == "No") {
            lep[i].style.backgroundColor = '#f9b9b9';
        }
    }
    
    var eth = document.getElementsByClassName('eth')
    
    for (var i = 0; i < eth.length; i++) {
        if (eth[i].innerHTML == "Asian") {
            eth[i].style.backgroundColor = '#FF8080';
        } else if (eth[i].innerHTML == "Caucasian") {
            eth[i].style.backgroundColor = '#fbd3b2';
        } else if (eth[i].innerHTML == "Hispanic") {
            eth[i].style.backgroundColor = '#f7fbb4';
        } else if (eth[i].innerHTML == "African-American ") {
            eth[i].style.backgroundColor = '#a4fbaa';
        } else if (eth[i].innerHTML == "Two or more races") {
            eth[i].style.backgroundColor = '#b4fdde';
        } else if (eth[i].innerHTML == "American Indian") {
            eth[i].style.backgroundColor = '#f7abc7';
        } else if (eth[i].innerHTML == "Pacific Islander") {
            eth[i].style.backgroundColor = '#b494c5';
        } else if (eth[i].innerHTML == "Middle Eastern or North African") {
            eth[i].style.backgroundColor = '#bae1ff';
        }
    }
    
    var score = document.getElementsByClassName('score')
    scoretest = '80'
    for (var i = 0; i < score.length; i++) {
        if (parseInt(score[i].innerHTML) > 80) {
            score[i].style.backgroundColor = '#bae1ff';
        } else if (parseInt(score[i].innerHTML) > 60){
            score[i].style.backgroundColor = '#baffc9';
        } else if (parseInt(score[i].innerHTML) > 40){
            score[i].style.backgroundColor = '#ffffba';
        } else if (parseInt(score[i].innerHTML) > 20){
            score[i].style.backgroundColor = '#ffdfba';
        } else if (parseInt(score[i].innerHTML) >= 0){
            score[i].style.backgroundColor = '#ffb3ba';
        }
    }
    
    function exportXLSX() {
        const workbook = XLSX.utils.book_new();
        const worksheet = XLSX.utils.table_to_sheet(document.getElementById('dataresults'))
        
        for (const [key, value] of Object.entries(worksheet)) {
            
            if (key.includes('G')) {
                if (value.v == '5Blue' || value.v == '6Blue') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: '86e1e0'}
                        }
                    }
                } else if (value.v == '5Green' || value.v == '6Green') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'a4fbaa'}
                        }
                    }
                } else if (value.v == '5Orange' || value.v == '6Orange') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'fbd3b2'}
                        }
                    }
                } else if (value.v == '5Purple' || value.v == '6Purple') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'b494c5'}
                        }
                    }
                } else if (value.v == '5Red' || value.v == '6Red') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'FF8080'}
                        }
                    }
                }
                
            }
            
            
            if (key.includes('H') || key.includes('I') || key.includes('J') || key.includes('K') || key.includes('L') || key.includes('M')){
                if (value.v == "Yes"){
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'CDFAD5'}
                        }
                    }
                } else if (value.v == "No") {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'F9B9B9'}
                        }
                    }
                }
                
            }

            if (key.includes('O') || key.includes('P') || key.includes('Q') || key.includes('R') || key.includes('S') || key.includes('T') || key.includes('U') || key.includes('V') || key.includes('W') || key.includes('X') || key.includes('Y') || key.includes('Z') || key.includes('AA') || key.includes('AB') || key.includes('AC') || key.includes('AD') || key.includes('AE') || key.includes('AF') || key.includes('AG') || key.includes('AH') || key.includes('AI') || key.includes('AJ') || key.includes('AK') || key.includes('AL') || key.includes('AM') || key.includes('AN') || key.includes('AO') || key.includes('AP') || key.includes('AQ') || key.includes('AR') || key.includes('AS') || key.includes('AT') || key.includes('AU') || key.includes('AV') || key.includes('AW') || key.includes('AX')) {
                if (value.v >= 80) {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'BAE1FF'}
                        }
                    }
                } else if (value.v >= 60 && value.v < 80) {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'CDFAD5'}
                        }
                    }
                } else if (value.v >= 40 && value.v < 60) {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'FFFFBA'}
                        }
                    }
                } else if (value.v >= 20 && value.v < 40) {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'FFDFBA'}
                        }
                    }
                } else if (value.v >= 0 && value.v < 20) {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'F9B9B9'}
                        }
                    }
                } 
            }
            
            if (key.includes('N')) {
                if (value.v == 'Asian') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'FF8080'}
                        }
                    }
                } else if (value.v == 'Caucasian') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'fbd3b2'}
                        }
                    }
                } else if (value.v == 'Hispanic') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'f7fbb4'}
                        }
                    }
                } else if (value.v == 'African-American ') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'a4fbaa'}
                        }
                    }
                } else if (value.v == 'Two or more races') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'b4fdde'}
                        }
                    }
                } else if (value.v == 'American Indian') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'f7abc7'}
                        }
                    }
                } else if (value.v == 'Pacific Islander') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'b494c5'}
                        }
                    }
                } else if (value.v == 'Middle Eastern or North African') {
                    worksheet[key].s = {
                        fill: {
                            fgColor: {rgb: 'bae1ff'}
                        }
                    }
                } 
            }
        }
        
        
        // used for hiding certain columns in the sheet based on season
        if (((month == 11) && (year == currentYear)) || (((month >= 0) && (month < 3) && (year == (currentYear + 1))))) {
            // Just hides spring O-R
            
            for (var i = 14; i < 18; i++) {
                if(!worksheet["!cols"]) worksheet["!cols"] = [];
                if(!worksheet["!cols"][i]) worksheet["!cols"][i] = {wch: 8};
                worksheet["!cols"][i].hidden = true;
            }
        } else if (((month >= 9) && (month < 11)) && (year == currentYear)) {
            // Hides winter and spring O-V
            for (var i = 14; i < 22; i++) {
                if(!worksheet["!cols"]) worksheet["!cols"] = [];
                if(!worksheet["!cols"][i]) worksheet["!cols"][i] = {wch: 8};
                worksheet["!cols"][i].hidden = true;
            }
        }
        
        // use to hide certain columns based on school
        if ((s != '5177') && (s != '0')) {
            if(!worksheet["!cols"]) worksheet["!cols"] = [];
            if(!worksheet["!cols"][6]) worksheet["!cols"][6] = {wch: 8};
            worksheet["!cols"][6].hidden = true;
            
            if ((s != '5197')) {
                if(!worksheet["!cols"]) worksheet["!cols"] = [];
                if(!worksheet["!cols"][7]) worksheet["!cols"][7] = {wch: 8};
                worksheet["!cols"][7].hidden = true;
                if(!worksheet["!cols"]) worksheet["!cols"] = [];
                if(!worksheet["!cols"][8]) worksheet["!cols"][8] = {wch: 8};
                worksheet["!cols"][8].hidden = true;
            
            } 
        } 
        
        // const variable = 1

        // if (variable == 1) {

        //     /* Excel column "D" -> SheetJS column index 3 == XLSX.utils.decode_col("D") */
        //     var COL_INDEX = 4;

        //     /* create !cols array if it does not exist */
        //     if(!worksheet["!cols"]) worksheet["!cols"] = [];

        //     /* create column metadata object if it does not exist */
        //     if(!worksheet["!cols"][COL_INDEX]) worksheet["!cols"][COL_INDEX] = {wch: 8};

        //     /* set column to hidden */
        //     worksheet["!cols"][COL_INDEX].hidden = true;
        // }

        // console.log(worksheet)

        XLSX.utils.book_append_sheet(workbook, worksheet, "MAP");
        XLSX.writeFile(workbook, "MAP.xlsx");

    }
    
</script>
</body> 
</html>